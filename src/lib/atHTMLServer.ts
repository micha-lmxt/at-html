/* App.svelte generated by Svelte v3.52.0 */
import { create_ssr_component } from "svelte/internal";
import {parse,walk} from 'svelte/compiler';
import MagicString from 'magic-string';


export function atHTMLServer(htmltag: string) {

    const App = create_ssr_component(($$result:any, $$props:any, $$bindings:any, slots:any) => {
        const doc = new MagicString(htmltag);
        const ast= parse(htmltag);
        walk(ast,{
            enter:(node)=>{
                if (node.type==="Slot"){
                    const nameAttrib = node.attributes?.find((v:any)=>v.name="name")
                    const name = nameAttrib?nameAttrib.value[0]?.raw:"default";
                    if (name in slots){
                        const string = slots[name]();
                        
                        doc.update(node.start,node.end,"<!-- HTML_SLOT_START -->" +
                            string +
                            "<!-- HTML_SLOT_END -->")
                    }else{
                        doc.update(node.start,node.end,
                            node.children && node.children.length>0?
                            htmltag.slice(node.children[0].start,
                                node.children[node.children.length-1].end
                                )
                            :"");
                    }
                }
            }
        })
        return `<!-- HTML_TAG_START -->${doc.toString()}<!-- HTML_TAG_END -->`;
    });

    return App
}